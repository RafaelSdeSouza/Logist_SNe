beta.0~dnorm(0,0.001)
beta.1~dnorm(0,0.001)
#2. Likelihood
for (i in 1:N){
Y[i] ~ dbern(p[i])
logit(p[i]) <-  eta[i]
eta[i] <- beta.0+beta.1*mag_g[i]+ranef[galtype[i]]
#3. Prediction
prediction[i]~dbern(p[i])
}
}"
inits<-function () {
list(beta = rnorm(Ntype, 0, 0.1))}
params <- c("beta","prediction","ranef")
inits1=inits()
inits2=inits()
inits3=inits()
library(parallel)
cl <- makeCluster(3)
jags.logit <- run.jags(method="rjparallel", method.options=list(cl=cl),
data = jags.data,
inits = list(inits1,inits2,inits3),
model=model,
n.chains = 3,
adapt=2500,
monitor=c(params),
burnin=20000,
sample=30000,
summarise=FALSE,
thin=5,
plots=FALSE
)
inits()
summary
summary<-extend.jags(jags.logit,drop.monitor=c("prediction"), summarise=TRUE)
summary
require(ggmcmc)
L.factors <- data.frame(
Parameter=paste("ranef[", seq(1:5), "]", sep=""),
Label=c("S","S0","E/S0","E","Im"))
head(L.factors)
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("ranef"))
jagssamples <- as.mcmc.list(jags.logit)
require(ggmcmc)
L.factors <- data.frame(
Parameter=paste("ranef[", seq(1:5), "]", sep=""),
Label=c("S","S0","E/S0","E","Im"))
head(L.factors)
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("ranef"))
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
pdf("..//figures/ranef.pdf",width=7,height=7)
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
dev.off()
pdf("..//figures/density2.pdf",width=7,height=10)
ggs_density(beta_post)+theme_stata()+ylab("")
dev.off()
params <- c("beta.0","beta.1","prediction","ranef")
inits1=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
inits2=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
inits3=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
library(parallel)
cl <- makeCluster(3)
jags.logit <- run.jags(method="rjparallel", method.options=list(cl=cl),
data = jags.data,
inits = list(inits1,inits2,inits3),
model=model,
n.chains = 3,
adapt=2500,
monitor=c(params),
burnin=20000,
sample=40000,
summarise=FALSE,
thin=5,
plots=FALSE
)
jagssamples <- as.mcmc.list(jags.logit)
summary<-extend.jags(jags.logit,drop.monitor=c("prediction"), summarise=TRUE)
ranef_post<-ggs(jagssamples,par_labels=L.factors,family=c("ranef"))
pdf("..//figures/ranef.pdf",width=7,height=7)
ggs_caterpillar(ranef_post)+theme_stata()+ylab("")
dev.off()
pdf("..//figures/density2.pdf",width=7,height=10)
ggs_density(ranef_post)+theme_stata()+ylab("")
dev.off()
predtype<-summary(as.mcmc.list(jags.logit, vars="prediction"))
predtype<-predtype$quantiles
require(mlearning)
require(caret)
xtab <- table(predtype[,3], typeSne)
confusionMatrix(xtab)
predtype
xtab <- table(predtype[,4], typeSne)
confusionMatrix(xtab)
xtab <- table(predtype[,5], typeSne)
confusionMatrix(xtab)
xtab <- table(predtype[,2], typeSne)
confusionMatrix(xtab)
xtab <- table(predtype[,3], typeSne)
confusionMatrix(xtab)
summary<-extend.jags(jags.logit,drop.monitor=c("prediction"), summarise=TRUE)
summary
params <- c("beta.0","beta.1","prediction","ranef","p")
inits1=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
inits2=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
inits3=list(beta.0=rnorm(1,0,0.1),beta.1=rnorm(1,0,0.1))
library(parallel)
cl <- makeCluster(3)
jags.logit <- run.jags(method="rjparallel", method.options=list(cl=cl),
data = jags.data,
inits = list(inits1,inits2,inits3),
model=model,
n.chains = 3,
adapt=2500,
monitor=c(params),
burnin=20000,
sample=40000,
summarise=FALSE,
thin=5,
plots=FALSE
)
jagssamples <- as.mcmc.list(jags.logit)
jagssamples
prob<-summary(as.mcmc.list(jags.logit, vars="p"))
prob
require(gdata)
library(ggplot2)
library(ggthemes)
gd<-read.fwf("../data/ggdata.dat",width=c(11,13,13,14,27))
colnames(gd)<-c("SNtype","mag_g","bar","Galtype2","prob")
gd$Galtype2<-trim(as.factor(gd$Galtype2))
gd$bar<-trim(gd$bar)
gd$bar<-as.numeric(gd$bar)
gd$bar<-as.factor(gd$bar)
library(plyr)
gd$bar<-revalue(gd$bar, c("1"="No", "2"="Yes"))
gd$bar<-as.factor(gd$bar)
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2.5)+geom_line(data=gd,aes(group=bar))+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_shape_tremmel(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2.5)+geom_line(data=gd,aes(group=Galtype2))+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_shape_tremmel(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2.5)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_shape_tremmel(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar,linetype=bar))+
geom_point(size=2.5)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_shape_tremmel(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=2.5)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_tremmel(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=2.5)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(size=2,name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line(size=2,)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line(size=1.25)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line(size=1.25)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_discrete(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line(size=1)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_discrete(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar))+
geom_point(size=1.25)+geom_line(size=1)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar,shape=bar))+
geom_point()+geom_line(size=1)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,linetype=bar,shape=bar))+
geom_point()+geom_line(size=1)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_stata(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_discrete(name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(5,8),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point()+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(1,8),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(alpha=0.7)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(1,8),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(alpha=0.95)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(1,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(alpha=0.95)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2,alpha=0.95)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
pdf("..//figures/probs_GLM.pdf")
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2,alpha=0.95)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
dev.off()
pdf("..//figures/probs_GLM.pdf",height = 10,width = 12)
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2,alpha=0.95)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
dev.off()
pdf("..//figures/probs_GLM.pdf",height = 10,width = 12)
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=2)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
dev.off()
pdf("..//figures/probs_GLM.pdf",height = 10,width = 12)
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=3)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
dev.off()
pdf("..//figures/probs_GLM.pdf",height = 10,width = 12)
ggplot(data=gd,aes(x=mag_g,y=prob,colour=Galtype2,shape=bar))+
geom_point(size=3)+
theme_stata()+xlab("u-band")+ylab("Probability of CC event")+scale_x_reverse()+
scale_color_gdocs(name="Galaxy type")+scale_linetype_manual(values=c("solid","dotted"),name="Bar")+
scale_shape_manual(values=c(3,19),name="Bar")+
theme(strip.background = element_rect(fill="gray95"),
legend.position="bottom",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=20),
strip.text.x=element_text(size=20),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20))
dev.off()
library(pROC)
ROCF<-data.frame(True=typeSne,Predicted=prob[,3])
F1 <-roc(ROCF$True,ROCF$Predicted)
pdf("..//figures/ROC_GLM.pdf")
plot(F1, col="blue",auc.polygon.col="blue")
dev.off()
data.1= read.table(file="..//data//clean_cat.dat",header=TRUE,na.strings = "",sep="\t")
data.1$Galtype2<-trim(data.1$Galtype2)
galtype<-match(data.1$Galtype2,c("E","E/S0","S","S0","Im"))
Ntype<-length(unique(data.1$Galtype2))
typeSne<-match(trim(data.1$SNtype),c("Ia","CC"))-1
ROCF<-data.frame(True=typeSne,Predicted=prob[,3])
F1 <-roc(ROCF$True,ROCF$Predicted)
prob
gd$prob
ROCF<-data.frame(True=typeSne,Predicted=gd$prob)
F1 <-roc(ROCF$True,ROCF$Predicted)
plot(F1, col="blue",auc.polygon.col="blue")
pdf("..//figures/ROC_GLM.pdf")
plot(F1, col="blue",auc.polygon.col="blue")
dev.off()
plot(F1, col="blue",auc.polygon.col="blue",percent=TRUE)
plot.roc(F1, col="blue",auc.polygon.col="blue",percent=TRUE)
plot.roc(F1, col="blue",auc.polygon.col="blue")
plot.roc(F1, col="red",auc.polygon.col="blue")
plot.roc(F1, col="red",auc.polygon.col="blue",percent=TRUE)
pdf("..//figures/ROC_GLM.pdf")
plot.roc(F1, col="red",auc.polygon.col="blue",percent=TRUE)
dev.off()
plot.roc(F1, col="red",auc.polygon.col="blue",percent=TRUE,type="n")
plot.roc(F1, col="red",auc.polygon.col="blue",ci=TRUE, print.auc=TRUE)
plot.roc(F1, col="red",auc.polygon.col="blue", print.auc=TRUE)
pdf("..//figures/ROC_GLM.pdf")
plot.roc(F1, col="red",auc.polygon.col="blue", print.auc=TRUE)
dev.off()
pdf("..//figures/ROC_GLM.pdf")
plot.roc(F1, col="blue",auc.polygon.col="blue", print.auc=TRUE)
dev.off()
data(iris)
head(iris)
iris2<-iris[,c("Sepal.Length","Sepal.Width")]
colnames(iris2)
data(iris)
head(iris)
iris2<-iris[,c("Sepal.Length","Sepal.Width")]
head(iris2)
data(fish)
data("cars")
cars
cars[1,]
head(cars)
data(cars)
head(cars)
head(cars2)
cars2<-cars[,c("speed")]
head(cars2)
volcano
volcano[1,]
volcano[1,2]
data(iris)
colnames(iris)<-c("SL","SW","PL","PW","Species")
head(iris)
