<<<<<<< HEAD
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tck=0,colkey=list(length=0.35,dist=-0.075))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tck=0,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.01, facets = FALSE, lwd = 2)
hist3D(z = VV, scale = FALSE, expand = 0.01, facets = NA)
hist3D(z = VV, scale = TRUE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tck=0,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tck=0,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
dev.off()
table(VV)
VV
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tck=0,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE, ticktype = "detailed", space = 0.05,
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-9,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 0,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tick=FALSE,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,cex.tck=1e-9,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tcl=-.2,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "f",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tcl=-.2,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tcl=-.2,las = 1,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tcl=-.2,las = 2,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tcl=-.2,las = 3,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab="Number of SNe",axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,las = 3,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
library("plot3Drgl")
plotrgl()
install.packages("plot3Drgl", lib="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
library("plot3Drgl")
plotrgl()
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = 90),axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = 90),axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
mtext(side = 1, "Explanatory Variable", line = 2)
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
mtext(side = 2, "Explanatory Variable", line = 2)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
mtext(side = 2, "Explanatory Variable", line = 2)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
mtext(side = 3, "Explanatory Variable", line = 2)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(y = 0.5, x = 2, z = 0,
labels = "Galaxy Type",
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(y = 0.5, x = 2, z = 0,
labels = "Galaxy Type",
add = TRUE, adj = 0)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(y = 0.5, x = 2, z = 0,
labels = "Galaxy Type",
add = TRUE, adj = 0)
dev.off()
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(y = 0.5, x = 1.2, z = 0,
labels = "Galaxy Type",
add = TRUE, adj = 0)
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(y = 0.5, x = 1.2, z = 0,
labels = "Galaxy Type",
add = TRUE, adj = 0)
dev.off()
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=TRUE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
dev.off()
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
dev.off()
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(z = 300, x = 0, y = 0,
labels = labels2,
add = TRUE, adj = 0)
dev.off()
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(z = 300, x = 0, y = 0,
labels ="Number of SNe",
add = TRUE, adj = 0)
dev.off()
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(
clab="SNe count",length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
text3D(z = 300, x = 0, y = 0,
add = TRUE, adj = 0)
dev.off()
CairoPDF(file="Hist3D.pdf",height = 8,width = 8)
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(
clab="SNe count",length=0.35,dist=-0.075,tick=FALSE))
text3D(x = seq(0,1,0.2), y = rep(-0.25, 6), z = rep(0, 6),
labels = labels,
add = TRUE, adj = 0)
text3D(y = seq(0,1,0.25), x = rep(1.15, 5), z = rep(0, 5),
labels = labels2,
add = TRUE, adj = 0)
dev.off()
hist3D(z = VV, scale = FALSE, expand = 0.00175, bty = "g",
col = jet2.col(200, alpha = 0.5), border = "black",xlab="SNe",ylab="galaxy",
zlab=list("Number of SNe",rot = -90),axes=FALSE,  space = 0.05,ticktype = "detailed",
d = 1, cex.axis = 1e-10,tck = -.01,colkey=list(
clab="SNe count",length=0.35,dist=-0.075,tick=FALSE))
# save plotting parameters
pm <- par(mfrow = c(2, 2))
pmar <- par(mar = c(5.1, 4.1, 4.1, 2.1))
## =======================================================================
##  colorkey as argument of a plot3D function
## =======================================================================
# default, colkey = NULL: adds colkey because multiple colors
image2D(z = volcano)
# default, colkey = NULL: no colkey because only one color
image2D(z = volcano, col = "grey", shade = 0.2, contour = TRUE)
# colkey = FALSE: no color key, no extra space foreseen
image2D(z = volcano, colkey = FALSE)
# colkey = list(plot = FALSE): no color key, extra space foreseen
image2D(z = volcano, colkey = list(plot = FALSE, side = 3))
colkey (side = 3, add = TRUE, clim = range(volcano))
## =======================================================================
##  colorkey in new plot
## =======================================================================
colkey(side = 1, clim = c(0, 1), add = FALSE, clab = "z",
col.clab = "red", adj.clab = 0)
colkey(side = 2, clim = c(0, 1), clab = "z", length = 0.5, width = 0.5)
colkey(side = 3, clim = c(0, 1), lwd = 3, clab = c("a","b","c","d"),
line.clab = 5)
colkey(side = 4, clim = c(1e-6, 1), clog = TRUE,
clab = "a very long title in bold and close to the key",
line.clab = 1, side.clab = 2, font.clab = 2)
=======
ptm <- proc.time()
corr<-Corr_MIC(M1,"pearson")
Fig1<-plotdendrogram(corr,"fan")
proc.time() - ptm
1.432+0.044
help(package="AMADA")
install.packages("GGally")
library("GGally", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
data(diamonds, package="ggplot2")
diamonds.samp <- diamonds[sample(1:dim(diamonds)[1],200),]
# Custom Example
pm <- ggpairs(
diamonds.samp[,1:3],
upper = list(continuous = "density", combo = "box"),
lower = list(continuous = "points", combo = "dot"),
color = "cut",
title = "Diamonds"
)
pm
pm <- ggpairs(
diamonds.samp[,1:3],
upper = list(continuous = "density", combo = "box"),
lower = list(continuous = "density", combo = "dot"),
color = "cut",
title = "Diamonds"
)
pm
ggpairs(
diamonds.samp[,1:3],
upper = list(continuous = "density", combo = "box"),
lower = list(continuous = "density"),
color = "cut",
title = "Diamonds"
)
ggpairs(
diamonds.samp[,1:3],
upper = list(continuous = "density"),
lower = list(continuous = "density"),
color = "cut",
title = "Diamonds"
)
ggpairs(
iris[,1:4],
upper = list(continuous = "density"),
lower = list(continuous = "density"),
color = "cut",
title = "Diamonds"
)
ggpairs(
iris[,1:4],
upper = list(continuous = "density"),
lower = list(continuous = "density")
)
ggpairs(
iris[,1:4],
upper = list(continuous = "cor"),
lower = list(continuous = "density")
)
pm <- ggpairs(
iris[,1:4],
upper = list(continuous = "cor"),
lower = list(continuous = "density"),
diag=list("density")
)
pm
ggpairs(
iris[,1:4],
upper = list(continuous = "cor"),
lower = list(continuous = "density"),
diag=list("bar'")
)
pm <- ggpairs(
iris[,1:4],
diag=list("bar"),
upper = list(continuous = "cor"),
lower = list(continuous = "density")
)
pm
pm <- ggpairs(
iris[,1:4],
diag=list("bar"),
upper = list(continuous = "cor"),
lower = list(continuous = "hist")
)
pm
pm <- ggpairs(
iris[,1:4],
diag=list("continuous"),
upper = list(continuous = "cor"),
lower = list(continuous = "density")
)
pm
setwd("~/Dropbox/artigos/Meusartigos/IAA-WGC/Github/Logist_SNe/script")
#  Required libraries
library(rjags)
library(ggmcmc)
library(ggplot2)
library(ggthemes)
library(pander)
library(Cairo)
library(plyr)
library(MASS)
library(scales)
library(plyr)
require(gdata)
require(runjags)
require(gdata)
data.1= read.table(file="..//data//multinomial_cat.dat",header=TRUE,na.strings = "",sep="\t")
data.1$Galtype2<-trim(data.1$Galtype2)
galtype<-match(data.1$Galtype2,c("E","E/S0","S","S0","Im"))
Ntype<-length(unique(data.1$Galtype2))
typeSne<-match(trim(data.1$SNtype),c("Ia","Ib","Ib/c","Ic","II","IIn"))
bar<-as.numeric(data.1$bar)-1
jags.data <- list(y= typeSne,
N = nrow(data.1),
galtype = galtype,
bar=bar,
J=6,
Ntype = Ntype
)
model<- "model{
for(i in 1:N){
y[i] ~ dcat(p[i, 1:J])
for (j in 1:J){
log(q[i,j]) <-  beta[1,j] + beta[2,j]*bar[i]+ranef[galtype[i]]
p[i,j] <- q[i,j]/sum(q[i,1:J])
}   # close J loop
}  # close N loop
# Priors
#tau.R<-pow(sdBeta,-1)
#sdBeta ~ dgamma(0.001,0.001)
# Random intercept
for (j in 1:Ntype){
ranef[j]~dnorm(0,1e-5)
}
for(k in 1:2){
beta[k,1]~dbern(0) ## MUST set the first set of covariates (for the first outcome category) to 0
for(j in 2:J){
beta[k,j] ~ dnorm(0, 0.1)
}  # close J loop
}  # close K loop
}"  # close model loop
params<-c("beta","p","ranef")
inits<-function(){list(beta=structure(.Data=c(rep(NA,2),runif(2*(6-1),-1,1)),.Dim=c(2,6)))}
inits1=inits()
inits2=inits()
inits3=inits()
chain_inits<-list(inits1,inits2,inits3)
library(parallel)
cl <- makeCluster(3)
jags.mlogit <- run.jags(method="rjparallel",
data = jags.data,
inits = chain_inits,
model=model,
n.chains = 3,
adapt=1000,
monitor=c(params),
burnin=2000,
sample=50000,
summarise=FALSE,
plots=FALSE
)
jags.mlogit <- run.jags(method="rjparallel",
data = jags.data,
inits = chain_inits,
model=model,
n.chains = 3,
adapt=1000,
monitor=c(params),
burnin=2000,
sample=5000,
summarise=FALSE,
plots=FALSE
)
summary<-extend.jags(jags.mlogit,drop.monitor=c("p"), summarise=TRUE)
print(summary)
jagssamples <- as.mcmc.list(jags.mlogit)
L.factors <- data.frame(
Parameter=c(paste("beta[1,", seq(1:6), "]", sep=""),paste("beta[2,", seq(1:6), "]", sep="")),
Label=c("beta.0 Ia","beta.0 Ib","beta.0 Ib/c","beta.0 Ic","beta.0 II",
"beta.0 IIn","beta.1 Ia","beta.1 Ib","beta.1 Ib/c","beta.1 Ic","beta.1 II",
"beta.1 IIn"))
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("beta"))
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
galtype
model<- "model{
for(i in 1:N){
y[i] ~ dcat(p[i, 1:J])
for (j in 1:J){
log(q[i,j]) <-  beta[1,j] + beta[2,j]*bar[i]+beta[3,j]*ranef[galtype[i]]
p[i,j] <- q[i,j]/sum(q[i,1:J])
}   # close J loop
}  # close N loop
# Priors
#tau.R<-pow(sdBeta,-1)
#sdBeta ~ dgamma(0.001,0.001)
# Random intercept model
for (j in 1:Ntype){
#ranef[j]~dnorm(0,1e-5)
ranef[j]~ddexp(0,1/1.64)
}
for(k in 1:3){
beta[k,1]~dbern(0) ## MUST set the first set of covariates (for the first outcome category) to 0
for(j in 2:J){
beta[k,j] ~ dnorm(0, 0.1)
}  # close J loop
}  # close K loop
}"  # close model loop
inits
inits()
inits<-function(){list(beta=structure(.Data=c(rep(NA,3),runif(2*(6-1),-1,1)),.Dim=c(2,6)))}
inits()
inits<-function(){list(beta=structure(.Data=c(rep(NA,3),runif(3*(6-1),-1,1)),.Dim=c(3,6)))}
inits()
inits<-function(){list(beta=structure(.Data=c(rep(NA,3),runif(3*(6-1),-1,1)),.Dim=c(3,6)))}
inits1=inits()
inits2=inits()
inits3=inits()
chain_inits<-list(inits1,inits2,inits3)
library(parallel)
cl <- makeCluster(3)
jags.mlogit <- run.jags(method="rjparallel",
data = jags.data,
inits = chain_inits,
model=model,
n.chains = 3,
adapt=1000,
monitor=c(params),
burnin=2000,
sample=5000,
summarise=FALSE,
plots=FALSE
)
print(summary)
model<- "model{
for(i in 1:N){
y[i] ~ dcat(p[i, 1:J])
for (j in 1:J){
log(q[i,j]) <-  beta[1,j] + beta[2,j]*bar[i]+ranef[galtype[i],j]
p[i,j] <- q[i,j]/sum(q[i,1:J])
}   # close J loop
}  # close N loop
# Priors
#tau.R<-pow(sdBeta,-1)
#sdBeta ~ dgamma(0.001,0.001)
# Random intercept model
for (k in 1:Ntype){
#ranef[j]~dnorm(0,1e-5)
ranef[k,1]~dbern(0)
for(j in 2:J){
ranef[k,j]~ddexp(0,1/1.64)
}
}
for(k in 1:2){
beta[k,1]~dbern(0) ## MUST set the first set of covariates (for the first outcome category) to 0
for(j in 2:J){
beta[k,j] ~ dnorm(0, 0.1)
}  # close J loop
}  # close K loop
}"  # close model loop
params<-c("beta","p","ranef")
inits<-function(){list(beta=structure(.Data=c(rep(NA,2),runif(2*(6-1),-1,1)),.Dim=c(2,6)))}
inits1=inits()
inits2=inits()
inits3=inits()
chain_inits<-list(inits1,inits2,inits3)
jags.mlogit <- run.jags(method="rjparallel",
data = jags.data,
inits = chain_inits,
model=model,
n.chains = 3,
adapt=1000,
monitor=c(params),
burnin=2000,
sample=5000,
summarise=FALSE,
plots=FALSE
)
summary<-extend.jags(jags.mlogit,drop.monitor=c("p"), summarise=TRUE)
print(summary)
jagssamples <- as.mcmc.list(jags.mlogit)
cof_post<-ggs(jagssamples)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
pdf("..//figures/multi_all.pdf",width=10,height=14)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
jagssamples
cof_post<-ggs(jagssamples,family=c("ranef","beta"))
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("beta"))
pdf("..//figures/multi_beta.pdf",width=8,height=10)
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
dev.off()
cof_post<-ggs(jagssamples,family=c("ranef"))
pdf("..//figures/multi_ranef.pdf",width=8,height=10)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
pdf("..//figures/multi_ranef.pdf",width=10,height=16)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
pdf("..//figures/multi_ranef.pdf",width=12,height=20)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
ggs_traceplot(cof_post)+theme_stata()+ylab("")
ggs_traceplot(beta_post)+theme_stata()+ylab("")
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
cof_post
cof_post[1,]
summary(cof_post$Parameter)
cof_post$Parameter
rep(c("E","E/S0","S","S0","Im"),each=1500)
summary(cof_post$Parameter)
rep(c(1,4,5),4)
rep(c(1,4,5),each=4)
galaxies<-rep(rep(c("E","E/S0","S","S0","Im"),each=1500),6)
supernova<-rep(c("Ia","Ib","Ib/c","Ic","II","IIn"),each=6*1500)
supernova<-rep(c("Ia","Ib","Ib/c","Ic","II","IIn"),each=5*1500)
galaxies<-rep(rep(c("E","E/S0","S","S0","Im"),each=15000),6)
supernova<-rep(c("Ia","Ib","Ib/c","Ic","II","IIn"),each=5*15000)
cof_post$galaxies<-galaxies
cof_post$supernova<-supernova
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(~supernova)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(.~supernova)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(supernova~.)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(supernova~)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(supernova.~)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(supernova~galaxies)
cof_post
ggs_caterpillar(cof_post,color=supernova)+theme_stata()+ylab("")
ggs_caterpillar(cof_post)+aes(data=cof_post,colour=supernova)
ggs_caterpillar(cof_post)+scale_colour(data=cof_post,colour=supernova)
ggs_caterpillar(cof_post)+scale_colour_stata(data=cof_post,colour=supernova)
cof_post$galaxies<-as.factor(galaxies)
cof_post$supernova<-as.factor(supernova)
ggs_caterpillar(cof_post)+scale_colour_stata(data=cof_post,colour=supernova)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+facet_wrap(~supernova)
cof_post[1,]
gcof<-cof_pos[,c(4,5,6)]
gcof<-cof_post[,c(4,5,6)]
ggplot(data=gcof,aes(x=value,fill=galaxies))+geom_density()+facet_wrap(~supernova)+
theme_stata()
ggplot(data=gcof,aes(x=value,fill=galaxies))+geom_density()+facet_wrap(~supernova,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,fill=supernova))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,fill=supernova,alpha=0.5))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,fill=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,fill=white,colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,fill="white",colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=gcof,aes(x=value,colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
library("lme4")
data(package = "lme4")
# Dyestuff
# a balanced one-way classiï¬cation of Yield
# from samples produced from six Batches
summary(Dyestuff)
# Batch is an example of a random effect
# Fit 1-way random effects linear model
fit1 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
summary(fit1)
coef(fit1) #intercept for each level in Batch
# qqplot of the random effects with their variances
qqmath(ranef(fit1, postVar = TRUE), strip = FALSE)$Batch
ranef(fit1, postVar = TRUE)
qqmath(ranef(fit1), strip = FALSE)$Batch
ranef(fit1, condVar = TRUE)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
L.factors <- data.frame(
Parameter=c(paste("beta[1,", seq(1:6), "]", sep=""),paste("beta[2,", seq(1:6), "]", sep="")),
Label=c("beta.0 Ia","beta.0 Ib","beta.0 Ib/c","beta.0 Ic","beta.0 II",
"beta.0 IIn","beta.1 Ia","beta.1 Ib","beta.1 Ib/c","beta.1 Ic","beta.1 II",
"beta.1 IIn"))
head(L.factors)
for (i in 1:n.cols){
for (j in 1:n.rows){
my.matrix.2[j,i] <- paste(prefix, paste(r.suffix[j], c.suffix[i], sep = "."), sep = ".")
}
}; rm(i,j)
my.matrix.2
for (i in 1:6){
for (j in 1:4){
my.matrix.2[j,i] <- paste(prefix, paste(r.suffix[j], c.suffix[i], sep = "."), sep = ".")
}
}; rm(i,j)
my.matrix.2
cof_post$Parameter
paste("ranef[",seq(1:5), "1]", sep="")
paste("ranef[",seq(1:5), ",1]", sep="")
c(paste("ranef[",seq(1:5), ",1]", sep=""),paste("ranef[",seq(1:5), ",2]", sep=""),paste("ranef[",seq(1:5), ",3]", sep=""),
paste("ranef[",seq(1:5), ",4]", sep=""),paste("ranef[",seq(1:5), ",5]", sep=""),paste("ranef[",seq(1:5), ",6]", sep=""))
L.factors2<-data.frame(
Parameter=c(paste("ranef[",seq(1:5), ",1]", sep=""),paste("ranef[",seq(1:5), ",2]", sep=""),paste("ranef[",seq(1:5), ",3]", sep=""),
paste("ranef[",seq(1:5), ",4]", sep=""),paste("ranef[",seq(1:5), ",5]", sep=""),paste("ranef[",seq(1:5), ",6]", sep="")),
Label=c("E-Ia","E/S0-Ia","S-Ia","S0-Ia","Im-Ia","E-Ib","E/S0-Ib","S-Ib","S0-Ib","Im-Ib","E-Ib","E/S0-Ib","S-Ib","S0-Ib","Im-Ib",
"E-Ic","E/S0-Ic","S-Ic","S0-Ic","Im-Ic","E-II","E/S0-II","S-II","S0-II","Im-II","E-IIn","E/S0-IIn","S-IIn","S0-IIn","Im-IIn"),
supernova=rep(c("Ia","Ib","Ibc","Ic","II","IIn"),each=5),galaxies=rep(c("E","E/S0","S","S0","Im"),6))
ggs_caterpillar(cof_post,par_labels=L.factors2)+theme_stata()+ylab("")+aes(color=supernova)+facet_wrap(~galaxies)
L.factors2
cof_post<-ggs(jagssamples,par_labels=L.factors2,family=c("ranef"))
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)+facet_wrap(~galaxies)
ggs_caterpillar(cof_post)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
L.factors2
galtype
data.1$Galtype2
L.factors2<-data.frame(
Parameter=c(paste("ranef[",seq(1:5), ",1]", sep=""),paste("ranef[",seq(1:5), ",2]", sep=""),paste("ranef[",seq(1:5), ",3]", sep=""),
paste("ranef[",seq(1:5), ",4]", sep=""),paste("ranef[",seq(1:5), ",5]", sep=""),paste("ranef[",seq(1:5), ",6]", sep="")),
Label=c("E-Ia","E/S0-Ia","S-Ia","S0-Ia","Im-Ia","E-Ib","E/S0-Ib","S-Ib","S0-Ib","Im-Ib","E-Ibc","E/S0-Ibc","S-Ibc","S0-Ibc","Im-Ibc",
"E-Ic","E/S0-Ic","S-Ic","S0-Ic","Im-Ic","E-II","E/S0-II","S-II","S0-II","Im-II","E-IIn","E/S0-IIn","S-IIn","S0-IIn","Im-IIn"),
supernova=rep(c("Ia","Ib","Ibc","Ic","II","IIn"),each=5),galaxies=rep(c("E","E/S0","S","S0","Im"),6))
cof_post<-ggs(jagssamples,par_labels=L.factors2,family=c("ranef"))
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
L.factors2
cof_post
cof_post[1,]
jagssamples
cof_post$galaxies<-as.factor(galaxies)
cof_post$supernova<-as.factor(supernova)
cof_post
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)+facet_wrap(~galaxies)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
pdf("..//figures/multi_ranef.pdf",width=12,height=20)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)+facet_wrap(~galaxies)
dev.off()
pdf("..//figures/multi_ranef.pdf",width=12,height=20)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
L.factors2
typeSne
data.1$SNtype
Ntype
inits()
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
L.factors2
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
ggs_caterpillar(ggs(jagssamples,family="ranef"))+theme_stata()+ylab("")
c(paste("ranef[1,",seq(1:5), "]", sep=""),paste("ranef[2,",seq(1:5), "]", sep=""),paste("ranef[3,",seq(1:5), "]", sep=""),
paste("ranef[4,",seq(1:5), "]", sep=""),paste("ranef[5,",seq(1:5), "]", sep=""),paste("ranef[6,",seq(1:5), "]", sep=""))
c(paste("ranef[1,",seq(1:6), "]", sep=""),paste("ranef[2,",seq(1:6), "]", sep=""),paste("ranef[3,",seq(1:6), "]", sep=""),
paste("ranef[4,",seq(1:6), "]", sep=""),paste("ranef[5,",seq(1:6), "]", sep=""))
L.factors2<-data.frame(
Parameter=c(paste("ranef[1,",seq(1:6), "]", sep=""),paste("ranef[2,",seq(1:6), "]", sep=""),paste("ranef[3,",seq(1:6), "]", sep=""),
paste("ranef[4,",seq(1:6), "]", sep=""),paste("ranef[5,",seq(1:6), "]", sep="")),
Label=c("E-Ia","E-Ib","E-Ibc","E-Ic","E-II","E-IIn","E/S0-Ia","E/S0-Ib","E/S0-Ibc","E/S0-Ic","E/S0-II","E/S0-IIn",
"S-Ia","S-Ib","S-Ibc","S-Ic","S-II","S-IIn","S0-Ia","S0-Ib","S0-Ibc","S0-Ic","S0-II","S0-IIn",
"Im-Ia","Im-Ib","Im-Ibc","Im-Ic","Im-II","Im-IIn"),
supernova=rep(c("Ia","Ib","Ibc","Ic","II","IIn"),each=5),galaxies=rep(c("E","E/S0","S","S0","Im"),6))
L.factors2<-data.frame(
Parameter=c(paste("ranef[1,",seq(1:6), "]", sep=""),paste("ranef[2,",seq(1:6), "]", sep=""),paste("ranef[3,",seq(1:6), "]", sep=""),
paste("ranef[4,",seq(1:6), "]", sep=""),paste("ranef[5,",seq(1:6), "]", sep="")),
Label=c("E-Ia","E-Ib","E-Ibc","E-Ic","E-II","E-IIn","E/S0-Ia","E/S0-Ib","E/S0-Ibc","E/S0-Ic","E/S0-II","E/S0-IIn",
"S-Ia","S-Ib","S-Ibc","S-Ic","S-II","S-IIn","S0-Ia","S0-Ib","S0-Ibc","S0-Ic","S0-II","S0-IIn",
"Im-Ia","Im-Ib","Im-Ibc","Im-Ic","Im-II","Im-IIn"),
supernova=rep(c("Ia","Ib","Ibc","Ic","II","IIn"),5),galaxies=rep(c("E","E/S0","S","S0","Im"),each=6))
cof_post<-ggs(jagssamples,par_labels=L.factors2,family="ranef")
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
gcof<-cof_post[,c(4,5,6)]
ggplot(data=gcof,aes(x=value,colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
ggplot(data=cof_post,aes(x=value,colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
galaxies<-rep(rep(c("E","E/S0","S","S0","Im"),each=15000),6)
supernova<-rep(c("Ia","Ib","Ib/c","Ic","II","IIn"),each=5*15000)
cof_post$galaxies<-as.factor(galaxies)
cof_post$supernova<-as.factor(supernova)
ggplot(data=cof_post,aes(x=value,colour=supernova,alpha=0.4))+geom_density()+facet_wrap(~galaxies,scale="free")+
theme_stata()
cof_post
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
L.factors2
L.factors2<-data.frame(
Parameter=c(paste("ranef[1,",seq(1:6), "]", sep=""),paste("ranef[2,",seq(1:6), "]", sep=""),paste("ranef[3,",seq(1:6), "]", sep=""),
paste("ranef[4,",seq(1:6), "]", sep=""),paste("ranef[5,",seq(1:6), "]", sep="")),
Label=c("E-Ia","E-Ib","E-Ibc","E-Ic","E-II","E-IIn","E/S0-Ia","E/S0-Ib","E/S0-Ibc","E/S0-Ic","E/S0-II","E/S0-IIn",
"S-Ia","S-Ib","S-Ibc","S-Ic","S-II","S-IIn","S0-Ia","S0-Ib","S0-Ibc","S0-Ic","S0-II","S0-IIn",
"Im-Ia","Im-Ib","Im-Ibc","Im-Ic","Im-II","Im-IIn"),
supernova=as.factor(rep(c("Ia","Ib","Ibc","Ic","II","IIn"),5)),galaxies=as.factor(rep(c("E","E/S0","S","S0","Im"),each=6)))
cof_post<-ggs(jagssamples,par_labels=L.factors2,family="ranef")
ggs_caterpillar(cof_post)+theme_stata()+ylab("")+aes(color=supernova)
dim(cof_post)
pdf("..//figures/multi_ranef.pdf",width=12,height=20)
ggs_caterpillar(cof_post)+theme_stata()+ylab("")
dev.off()
pdf("..//figures/multi_beta.pdf",width=8,height=10)
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
dev.off()
L.factors <- data.frame(
Parameter=c(paste("beta[1,", seq(1:6), "]", sep=""),paste("beta[2,", seq(1:6), "]", sep="")),
Label=c("Ia","Ib","Ib/c","Ic","II",
"IIn","Bar-Ia","Bar-Ib","Bar-Ib/c","Bar-Ic","Bar-II",
"beta.1 IIn"))
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("beta"))
pdf("..//figures/multi_beta.pdf",width=8,height=10)
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
dev.off()
L.factors <- data.frame(
Parameter=c(paste("beta[1,", seq(1:6), "]", sep=""),paste("beta[2,", seq(1:6), "]", sep="")),
Label=c("Ia","Ib","Ib/c","Ic","II",
"IIn","Bar-Ia","Bar-Ib","Bar-Ib/c","Bar-Ic","Bar-II",
"Bar-IIn"))
#head(L.factors)
beta_post<-ggs(jagssamples,par_labels=L.factors,family=c("beta"))
pdf("..//figures/multi_beta.pdf",width=8,height=10)
ggs_caterpillar(beta_post)+theme_stata()+ylab("")
dev.off()
>>>>>>> origin/master
